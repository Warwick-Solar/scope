Theory========In this section, some theory behind some functions is explained.fit_fourier***************In the 'fit_fourier' function, we fit the FFT spectrum by a power law model in log-log scale to extract the power law index and noise energy of the signal. Firstly, we must note that each point of the Fourier power :math:`I(f_{j})` follows a chi-square distribution with 2 degrees of freedom, denoted as:.. math::    I(f_{j}) = \mathcal{P}(f_{j}) \chi_{2}^{2}/2where :math:`\mathcal{P}(f_{j})` is the true power spectrum, and :math:`\chi_{2}^{2}` is a random variable distributed as :math:`\chi^{2}` with 2 degrees of freedom. Since the least squares method assumes that each point is Gaussian-distributed, we cannot directly apply this method in the FFT spectrum fitting. Instead, we should consider the mean of the :math:`\chi_{2}^{2}/2` term. In log scale, :math:`\left\langle \mathrm{log}(\chi^{2}_{2}/2) \right\rangle = -0.25068`. This term corresponds to the bias that will be introduced to the fitting if we directly implement the least squares method. Hence, we shall include this term in the model function such that the least squares fitting will not be 'biased'.Additionally, we can visualise this bias factor. Since the Fourier power follows a chi-square distribution with 2 DoF is essentially an exponential function, we consider the integration of an exponential function over the entire range of power, which gives a constant value:.. math::    \int_{0}^{P_{\mathrm{max}}} e^{-x} dx = const.One can transform it to log scale by considering a new variable :math:`Ï„ = lnx`. Hence, the new integral becomes:.. math::    \int_{-\infty}^{\mathrm{ln} P_{\mathrm{max}}} e^{-e^{\tau}} e^{\tau} d\tau = const.where :math:`F(\tau) = e^{-e^{\tau}} e^{\tau}` is the distribution of the Fourier power in log scale. By plotting this function we see an asymmetric distribution with its mean positioned at -0.25068... image:: ../_static/bias_visualisation.png    :align: centerThe power law model is a superposition of white and coloured noises, given by:.. math::    \mathcal{P}(f) = \mathcal{P}_{c}(f) + \mathcal{P}_{w}(f) = N_{c} f^{-\alpha_{c}} + N_{w}    where :math:`N_{c}` and :math:`N_{w}` are the proportionality constants of coloured and white noises respectively, and :math:`\alpha_{c}` is the power law index of coloured noise. After obtaining the proportionality constants from the debiased least squares fit, we can estimate the energy of each noise type using:.. math::        \text{Energy} = N \cdot nf \cdot N_{c/w} where :math:`N` is the number of data points in time series and :math:`nf` is the number of Fourier frequencies, which does not include 0 Hz and Nyquist frequency.emd_noise_conf***************`Flandrin et al. (2004) <https://ieeexplore.ieee.org/document/1261951>`__ and `Wu and Huang (2004) <https://royalsocietypublishing.org/doi/10.1098/rspa.2003.1221>`__ investigate the dyadic property of EMD and suggest the following relation between modal energy and modal period:.. math::        E_{m}P_{m} = \text{const.}`Kolotkov et al. (2016) <https://doi.org/10.1051/0004-6361/201628306>`__ suggests that the modal energy of the mth IMF should have a chi-square distribution with the :math:`k` degrees of freedom (DoF). We thus estimate the confidence limits using the percent-point function of the chi-square distribution. Here we use the false alarm probability = 0.05. The 'emd_noise_conf' function generates 500 (by default)noise samples with the same power law index and energy as the input and conducts the EMD. It extracts the dominant period and modal energy for each IMF by calling the 'emd_period_energy' function. The 'emd_noise_fit' function fits the chi-square distributionto the histogram of modal energy for each mode number to extract the mean energy and :math:`k`. We obtain the mean period, mean energy and number of DoF for each mode number.Due to the dyadic property of EMD, we expect both mean energy vsmean period and :math:`k` vs mean period are linear in log-log scale. The exactlinear relationship is found by fitting a straight line. By obtaining this linear relationship, we use it to generate 500 data points of the confidence limits over the whole range of period.